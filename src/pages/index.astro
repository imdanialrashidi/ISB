---
import Badge from "../components/Badge.astro";
import ContactCTA from "../components/ContactCTA.astro";
import Hero from "../components/Hero.astro";
import ProjectCard from "../components/ProjectCard.astro";
import SectionTitle from "../components/SectionTitle.astro";
import ServiceCard from "../components/ServiceCard.astro";
import companyData from "../content/company.json";
import contactsData from "../content/contacts.json";
import projectsData from "../content/projects.json";
import servicesData from "../content/services.json";
import BaseLayout from "../layouts/BaseLayout.astro";
import { toPersianDigits } from "../lib/locale";
import type { CompanyContent, ContactsContent, ProjectItem, ServiceItem } from "../lib/types";

const company = companyData as CompanyContent;
const contacts = contactsData as ContactsContent;
const services = servicesData as ServiceItem[];
const projects = projectsData as ProjectItem[];

const featuredServices = services.slice(0, 6);
const featuredProjects = projects.slice(0, 6);
const mainPhone = contacts.phones[0];
const mainPhoneFa = toPersianDigits(mainPhone.number);
const whatsappHref =
  contacts.whatsapp.status === "active" && contacts.whatsapp.number
    ? `https://wa.me/${contacts.whatsapp.number.replace(/[^\d]/g, "")}`
    : "/contact#whatsapp";
---

<BaseLayout
  title="ایمن صنعت باتاب"
  description="وب‌سایت رسمی ایمن صنعت باتاب؛ ارائه خدمات ایمنی، آموزش و مشاوره برای شرکت‌ها و پروژه‌های صنعتی و عمرانی."
  canonicalPath="/"
>
  <Hero
    title="ایمن صنعت باتاب؛ همراه قابل اعتماد شما در خدمات ایمنی و آموزش"
    subtitle={company.introduction}
    primaryCtaLabel={`تماس فوری: ${mainPhoneFa}`}
    primaryCtaHref={`tel:${mainPhone.tel}`}
    secondaryCtaLabel="درخواست همکاری در واتساپ"
    secondaryCtaHref={whatsappHref}
  />

  <section class="section-block">
    <div class="container-wrap">
      <SectionTitle
        title="خدمات کلیدی"
        subtitle="مجموعه‌ای از خدمات کاربردی برای ایمنی، آموزش و بهبود روندهای کاری در پروژه‌ها."
      />
      <div class="grid gap-4 md:grid-cols-2 xl:grid-cols-3">
        {featuredServices.map((service) => <ServiceCard service={service} />)}
      </div>
      <div class="mt-6">
        <a
          href="/services"
          class="text-sm font-semibold text-brand-accent hover:text-brand-primary"
        >
          مشاهده همه خدمات
        </a>
      </div>
    </div>
  </section>

  <section class="section-block bg-white">
    <div class="container-wrap">
      <SectionTitle
        title="پروژه‌های منتخب"
        subtitle="نمونه‌ای از همکاری‌های انجام‌شده و در حال اجرا در صنایع و پروژه‌های مختلف."
      />
      <div class="grid gap-4 md:grid-cols-2 xl:grid-cols-3">
        {featuredProjects.map((project) => <ProjectCard project={project} />)}
      </div>
      <div class="mt-6">
        <a
          href="/projects"
          class="text-sm font-semibold text-brand-accent hover:text-brand-primary"
        >
          مشاهده همه پروژه‌ها
        </a>
      </div>
    </div>
  </section>

  <section class="section-block">
    <div class="container-wrap grid gap-8 lg:grid-cols-2">
      <div class="card p-6">
        <SectionTitle title="چشم‌انداز و ارزش‌ها" subtitle={company.vision} />
        <ul class="space-y-2 text-sm leading-7 text-brand-text">
          {company.values.map((value) => <li>• {value}</li>)}
        </ul>
      </div>
      <div class="card p-6">
        <SectionTitle
          title="اعتمادسازی و استانداردها"
          subtitle="تعهد به انطباق، کیفیت و ایمنی در تمام مراحل پروژه."
        />
        <div class="flex flex-wrap gap-2">
          {company.standards.map((standard) => <Badge text={standard} tone="primary" />)}
        </div>
        <ul class="mt-5 space-y-2 text-sm leading-7 text-brand-text">
          {company.hseApproach.environment.map((item) => <li>• {item}</li>)}
        </ul>
      </div>
    </div>
  </section>

  <div class="container-wrap">
    <ContactCTA
      title="برای دریافت مشاوره تخصصی آماده‌ایم"
      description="برای شروع همکاری، دریافت مشاوره یا هماهنگی خدمات، از طریق تماس تلفنی یا واتساپ با ما در ارتباط باشید."
      phoneHref={`tel:${mainPhone.tel}`}
      phoneLabel={`تماس با ${mainPhone.label} (${mainPhoneFa})`}
      whatsappHref={whatsappHref}
    />
  </div>
</BaseLayout>
